# AGENTS.md
## 出力言語
このリポジトリに関するすべての説明・要約は日本語で記述してください。コードは変更せず、そのまま出力してください。

## 作業概要
Excelファイルにセルの内容を転記するExcel VBAマクロを作成する

## 言語
Excel VBA

## 仕様詳細  Version 1.0.0

# ユーザー入力につて
1. ユーザーからの入力はExcelのシート上から行う。

2. Excelのシートには以下2つのシートがある。
- mainシート

3. mainシートに以下がある。
- 実行ボタン
- 設定表
- 転記表

4. mainシートの設定表について
- 説明列：D6～D12
(1)転記先の検索列に転記元の検索列のワードが見つからない場合
(2)転記後にファイルを閉じない
(3)転記元の転記列が空の場合は無視する
(4)大文字小文字を区別する
(5)部分一致を許可する
(6)全角半角を区別する
(7)コメントとして転記する
- 設定列：H6～H12  ※全てコンボボックス
無視,中断
YES,NO
YES,NO
YES,NO
YES,NO
YES,NO
YES,NO

5. mainシートの転記表について
- 有効無効列：D19～  ※コンボボックス。DISABLE,ENABLE,STOPPERの3択
- 転記元ファイル名列：E19～  ※転記元のファイル名 or フルパスのファイル名を指定する。拡張子は*.xls, *.xlsx, *.xlsmに対応。
- 転記元シート名列：F19～  ※転記元のシート名を指定する。
- 転記元検索列：G19～  ※転記元の検索列の列名を指定する。(A～)
- 転記元転記列：H19～  ※転記元の転記列の列名を指定する。(A～)
- 転記先ファイル名列：E19～  ※転記先のファイル名 or フルパスのファイル名を指定する。拡張子は*.xls, *.xlsx, *.xlsmに対応。
- 転記先シート名列：F19～  ※転記先のシート名を指定する。
- 転記先検索列：G19～  ※転記先の検索列の列名を指定する。(A～)
- 転記先転記列：H19～  ※転記先の転記列の列名を指定する。(A～)

6. 実行ボタン押下時の処理の流れ
- (1) 有効無効列に空セル or STOPPERを検知した場合は実行処理を終了する。DISABLEを検知した場合はその行をスキップする。
      ENABLEを検知した場合は(2)に進む。
- (2) 転記元ファイル名列のExcelファイルを開き、(3)に進む。ファイルが存在しない場合はエラーメッセージを表示して終了する。
- (3) 転記元シート名列のシート名を(2)で開いたExcelファイルから探してアクティブにして(4)に進む。シートが存在しない場合はエラーメッセージを表示して終了する。
- (4) 転記元検索列の列名に注目し、背景色が黄色のセルだけに注目する。注目したセルの内容を保持して(5)に進む。
- (5) 転記元転記列の列名に注目し、(4)で注目したセルと同じ行のセルの内容を保持して(6)に進む。
- (6) 転記先ファイル名列のExcelファイルを開き、(7)に進む。ファイルが存在しない場合はエラーメッセージを表示して終了する。
- (7) 転記先シート名列のシート名を(6)で開いたExcelファイルから探してアクティブにして(8)に進む。シートが存在しない場合はエラーメッセージを表示して終了する。
- (8) 転記先検索列の列名に注目し、(4)で保持した内容と同じ内容のセルがあるか検索する。あった場合は(9)に進む。
- (9) 転記先転記列の列名に注目し、(5)で保持したセルの内容を(8)で検索した行に転記する。
- (10) 設定表で指定された設定は適宜上記処理に適用する。

#エラーメッセージについて
1. エラーの原因がわかるようなメッセージを出力する。

#デバッグログについて
1. 定数でON/OFF可能とする。
2. エラーの原因特定をするための詳細な情報をログファイルに出力する。
3. ファイル：SimpleTranscription_debug.log

#参考フォルダについて
- 以前に私が作成したExcel VBAを格納したもの。
- あまり良い実装では無いので参考程度に留めること。（コードを流用しないこと）
