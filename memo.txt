
■PoweerShell

<インストール/アップデート>
winget search Microsoft.PowerShell


■Gemini CLI
https://github.com/google-gemini/gemini-cli

<インストール/アップデート>
npm install -g @google/gemini-cli@latest



■Codex CLI
<インストール/アップデート>
npm install -g @openai/codex@latest

<環境構築>
1.WSL2を入れる
2.WSLからnode.js、codexを入れる

<起動方法>
1.PowerShellを管理者権限で開く
2.wsl
3.codex

<バージョン確認>
codex --version

<Tips>
- リポジトリにAGENTS.mdを入れておくとよいらしい。
  そんでもって、指示する前に以下を指示する。
  このディレクトリの AGENTS.md を読んで、記載のルールに従ってください。以後は日本語で説明して。指示があるまではファイルの更新は絶対にしないでください。

  ソースを読んで仕様を理解して、仕様の概要をAGENTS.mdに記載してください。
  ver1.0.6の仕様を追記しましたので、対応をお願いいたします。前バージョンのmdファイルは「AGENTS__old_1.0.5.md」です。
  AGENTS.mdの仕様を全て実装して。
  実装前に疑問点があれば確認してから実装を開始して。


  以下のタスクを、**5行以内で**、**最もシンプルな方法で**実装してください。
  - クラスや関数は必要最小限に。
  - コメント、エラーハンドリング、拡張性は一切不要。
  - 余計な処理や最適化は絶対に追加しない。
  - 動けばOK。


■ステップバイステップ
・各ステップを一気に述べるのではなく、1ステップを提示→そのステップをクリアするまで私とやりとりして
　クリアしたら次のステップに進む・・を繰り返すこと。



■WSL2
# pwdの結果をクリップボードにコピーする

pwd | clip.exe                           Linuxのパス形式でコピー
wslpath -w "$(pwd)" | clip.exe           Windowsのパス形式でコピー



■Visual Studio Community
#起動できなくなったとき：
1. %ProgramFiles(x86)%\Microsoft Visual Studio\Installer\InstallCleanup.exe を管理者権限で実行。
2. コマンド: InstallCleanup.exe -i 17（17 は VS2022 を指定）。
3. PC を再起動後、再インストール。

■Base32で使用される文字 (32文字。A-Z 2-7)
ABCDEFGHIJKLMNOPQRSTUVWXYZ234567


■
アップロードした文字列の画像をテキストにしてください。
ちなみに文字列のフォントはConsolasで、使用している文字種はBase32 + ハイフンのみです。（全て半角文字）



■Maven

# ビルド成果物を消して、最初からビルドして成果物をローカルリポジトリ（~/.m2/repository）に登録する （テストはスキップ）
mvn clean install

# ビルド  ※targetの下にjarが出来る
mvn clean package

# ビルド （テストはスキップ）
mvn clean package -DskipTests

# Springを起動
mvn spring-boot:run 

# Springを起動（テストはスキップ、ログ少なめ（-q））
mvn -q -DskipTests spring-boot:run

# Springを起動（テストはスキップ、ログ少なめ（-q）、プロジェクト指定（-pl））
mvn -pl job-01 -q -DskipTests spring-boot:run

# ライブラリのバージョン確認。以下はSpring Batchの例
mvn dependency:tree | grep spring-batch-core

# ターミナルのエンコードをUTF-8にする（pom.xmlを修正）
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>

            <!-- これを追加 >> -->

            <configuration>
                <jvmArguments>-Dsun.stdout.encoding=UTF-8 -Dfile.encoding=UTF-8</jvmArguments>
            </configuration>

            <!-- これを追加 << -->

        </plugin>
    </plugins>
</build>


# JARの中にファイルがあるか確認。
jar tf job-01/target/job-01-0.0.1-SNAPSHOT.jar | grep messages.properties

# 以下のような結果が出れば存在する
BOOT-INF/classes/messages.properties


■H2   ※メモリ型のDB

# SpringBoot起動時のログに以下が出ていればH2に接続できている状態
HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA

JavaとH2の型 (代表的なもののみ)
String        → VARCHAR / CLOB
int           → INT
long          → BIGINT
BigDecimal    → DECIMAL
boolean       → BOOLEAN
LocalDate     → DATE
LocalDateTime → TIMESTAMP
byte[]        → BLOB / VARBINARY


■Linux

# 8080ポートを誰がListenしているか?
ss -ltnp | grep 8080

# 全ファイル/フォルダを表示
ls -a



■VS Code

# フォントサイズ
拡大：Ctrl + +
縮小：Ctrl + -
左の歯車 → Settings → Editor: Font Size

# mdファイルをプレビュー  (拡張入れなくもOK)
CTRL + SHIFT + V

# プロジェクトのコピー
cd ~/projects
cp -r src dst
→Mavenの場合、pom.xmlをartifactidを変える

# ファイル検索
画面中央上の虫眼鏡

# ファイル内検索
画面左の虫眼鏡

# BASリロード
Ctrl + Shift + P → "Developer: Reload Window"


■Git

rm -rf .git
git init
git add .
git commit -m "first commit"
git remote add origin https://github.com/mtk57/SoapServerTest2.git
git branch -M main        # GitHub側が main ブランチの場合
git push -u origin main

# clone
1.左のSource ControlのCHANGESの...からclone
2.githubのURLを入れる

git clone https://github.com/mtk57/BatchH2MyBatisTest2.git

# git管理対象をツリー表示
git ls-tree -r --name-only HEAD | tree --fromfile .


■SAP BTP BASのSpring BatchからH2コンソールを使う
1.pom.xmlに以下を追加。(H2はメモリDBなのでバッチのようにアプリが終わってしまう場合はTomCatを常時起動しておく必要がある)
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-web</artifactId>
  </dependency>

2.application.properties
  spring.main.web-application-type=servlet  # Webサーバとして起動する
  #spring.main.web-application-type=none    # Webサーバとして起動しない(バッチアプリはこれ)

  spring.h2.console.enabled=true                    # H2コンソールを有効
  spring.h2.console.path=/h2-console                # 後で出てくるURLに付けるパス
  spring.h2.console.settings.web-allow-others=true  # H2コンソールを外部からアクセス可能にするか否か

  spring.batch.job.enabled=false        # バッチジョブの自動起動有無。falseだとアプリが起動してもジョブは起動せずWebサーバだけが立ち上がる
                                        # 以下のようなログが出ていなければ自動起動は抑止されている
                                          JobLauncherApplicationRunner : Running default command line with: ...
                                          Job: [SimpleJob: [name=sampleDataJob]] launched with the following parameters: ...
  spring.profiles.active=local          # テスト用/本番用の切り替え
  #spring.profiles.active=cloud         # テスト用/本番用の切り替え

3.ビルドしてアプリを起動する
  ログに以下が出ていればOK
  Tomcat started on port 8080 (http) with context path '/'
  H2 console available at '/h2-console'.

4.Ctrl + Shift + P
  Ports: Preview
  8080
  →ブラウザで新しいタブが勝手に開く
  
5.開いたタブのURLの末尾に
  /h2-console
  →H2コンソールが開く

6.H2コンソールのJDBC URLを
  jdbc:h2:mem:testdb
  にして「Connect」

この方法だとバッチが最後まで走り切った状態のDBを覗くことになるので
バッチが走る前にDBを変更したい場合は、

7.以下のクラスを追加
package com.example.batch_h2_mybatis_chunk_test.web;

import java.time.Instant;
import java.util.HashMap;
import java.util.Map;

import org.springframework.batch.core.Job;
import org.springframework.batch.core.JobParameters;
import org.springframework.batch.core.JobParametersBuilder;
import org.springframework.batch.core.launch.JobLauncher;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@Profile("local")
@RestController
public class JobRunController {

    private final JobLauncher jobLauncher;
    private final Job sampleDataJob;

    public JobRunController(JobLauncher jobLauncher, Job sampleDataJob) {
        this.jobLauncher = jobLauncher;
        this.sampleDataJob = sampleDataJob;
    }

    @GetMapping("/run-sample-job")
    public ResponseEntity<String> runJob() throws Exception {
        // ジョブパラメータに時刻を入れて、毎回別ジョブとみなしてもらう
        JobParameters params = new JobParametersBuilder()
                .addLong("runAt", Instant.now().toEpochMilli())
                .toJobParameters();

        jobLauncher.run(sampleDataJob, params);

        return ResponseEntity.ok("sampleDataJob started");
    }
}

8.ビルドして、手順3～6を実施

9.まだジョブは起動していないので、DBを変更しておく。

10.URLの/h2-console以降を
  /run-sample-job
  に変更
  →画面にsampleDataJob startedが出るのでジョブが開始される

11.元に戻すときは
   application.propertiesから以下をコメントアウト
   #spring.h2.console.enabled=true
   #spring.h2.console.path=/h2-console
   #spring.h2.console.settings.web-allow-others=true
   #spring.batch.job.enabled=false

   #spring.main.web-application-type=servlet
   spring.main.web-application-type=none

----------
FQCX WBLY WTDH VMSA 75N4 CMVN J426 2PE5-5M
5QIK B4EF LVSE VQTR 6HIS SAAN 27DZ PAQN-TS
BG2E CLZG BGFJ SZFL VDBJ POIZ YGVI WHBL-WM
7JG4 FPIH YOZ5 ZDYG CLP6 BEXO MQRV 2VNH-SD
KTEJ YRJQ UHXY KY6H L2GF KOJ7 5Z46 U6NQ-EH
4CRI JYI6 OTMA CTGF 56JN UD5B 6S2L 5MAG-EF
SFPH RIMH CGSS BYVI V6LM AIZK D2BA OANX-EG
XZ6R 6BV3 L2JL BYRC BUWY ZGWM 6ZOZ AXJU-3E
2KZJ WMRP 7DST FVKB SVGN X4IG OYYQ LUF7-LE
QL3A A3SS BSCU 6VE5 WZGU ZKJU NKC7 SQWB-Y5
XVDL K7ZQ HVDZ FVIX MIEB QF7K BUBN NI4N-B6
CAUS 6VTZ RXXM 4R6E XAKL KSBK IXTB W3UT-XN
6KWI XOX3 7T5F NPZP N7IA CYRV TJ2O SAK4-U2
RJLZ TETT YP2I S3UH VOQ6 JX5M KOBC RDLW-OM
HFYF BWUM DCFI KDPE RRRC Z3CB D7N6 SXRL-KJ
MGRD XQIY NJUZ AXSD K24I HPO7 3EBS YLID-63
42VA LYKD GF7U STEA QCI3 JFTH LSHS 3C66-5H
35FB QPYA 5GFZ T2CL S7VO KTR5 OBJ3 62VN-5R
HUY6 76R5 NFAX KVGD AASI A3SY ENZ2 RTMF-TX
QNGR KHEO 6SSK PDHN UXV2 IQBA J4RM OROJ-SH
SVNQ U4OK SL6D 4KZ3 XLKK 74N7 A2Y3 N67C-47
ETN6 6DXB KYXE TYN4 IECL 5NPD 57JG X4W3-HS
SUIL S6RT KFEM HYDI VBCR T6XM MUX3 CH2Q-GQ
BNPX 7KZC W32H XBDX TNDO 736H SXEK XJVV-DF
NAWA 3L7C 2DCV NTJL 4AU5 PABL LRMM QDSW-XI
FRXX IVR6 NAVV ZKIQ 64HM JVVZ QN5N HXYI-52
DWCT R4UV EDVQ EFEJ I72S UC2L 6I5A QH54-WP
XYVD V5AF M2UJ FOFH 33DP RJD4 ENDD ZAMM-H4
AD7D ST6E OUDN SVCQ PX4M 37CC SUS5 VXSA-BM
POQA MWA7 HHMN B7FO IXDI VD7D OGV7 S6YR-YG
MRUG YJPJ 6QQ4 QGJN LVLZ F7QM JWEY UM7P-VL
OC2A MAYA OJGE UDYS 2GVA WHXN HICN QKVJ-IW
NOKR 3QA6 BV5P UJAW 75WM 65W7 MQSX WKBQ-QW
MQOX XYOL 4SRS QLRF N2PF FT2R HNBY JVBO-XS
UAXP MRJ4 CIR4 7C4U Y5MD U6KR PSNK N3BG-5F
S7VM OESS TB2X ZMIS WSQR XQOP QCUX YKOY-TO
KAEL MF2T G7JC W7UJ GMEP VQFC 2HXQ MERY-NF
A4HV OHBL Z677 7CYO WLYA N74Z 3M46 QCGY-EI
ZAM3 K7Z3 ONVP 3USB IPDJ XHUH 24OS J2CN-IV
6E5B YNBG TV63 4HL2 VGN7 VEKZ KN2B EMEW-6W
AR25 IPFP PED4 EADA TN5R UZSN PTX4 EVQC-PZ
RGON 6P6Z 7ZV3 MGHF V6M4 EAXB YZBT QIMT-YB
JIUZ FPE4 GMJJ 4QIP WHAT TIUA E4NL 2CHY-6N
2IUH UBEN 5GIW KVGM O32D N2QF I7HK I7II-VD
7KJ4 37AS 5KXK FMWB ON5I TMOF MKGE 3BF5-DM
2TBJ 52RY AMAH PFJ6 ULZZ 34UD QJMD XZNK-6X
HKNO DGRZ JWOZ HGFS YMGU WT27 UHQM PPRE-4N
RQET GDGE HKEX AL2R J64U TTJA L3G2 7J5O-V3
GP5M WPHH 7FZ6 R5ZI FJ3Q TJUN AL3A 5MJE-4C
AW7J AEMJ VBVI ZIFA RXJ5 6RXX PBTN BC7R-TK
SDSY 5WSG NGIC PLSK 6YAI 2BSS BKYY CO6Z-MS
U3FY YAXH NW6E 6DNW RBJM 76YQ E7GS LZQR-T5
SOUL 5H4V GJWE XVDC MK57 NM6F HU7O PKMH-ZA
S2AU S5AQ LT4N I7P7 JDMG 525W 6WJF N6R2-TM
HY33 SDAI TZYL 72GY K3VT JGA5 KIQ2 YZRR-YP
73UC GIPO JSMM G3DT KU4T SSJ6 PEZB ZHPO-K4
YGM2 SJUU OQKC 2VC3 4Q47 Y6LT IUYT NAIN-US
GRRK UI2F GYI3 L6YK PRZ6 Q57U ZDA2 ZBWM-QP
WPUO CJS5 JNJL UKL5 ZNKW BILB N7JX TWRX-FY
E6ZE C2PI 6XIG ML3S ISRH 7WM2 WYGW TZ5U-6K
CAVA OXYH AFPO BWWO Z7YN 5AFB G6F4 F56T-C6
TJPS N72A 32CS V5NE GVJQ KQBH G6KS CXFS-7T
VBYO HENK T2BU YSWX QFLU RQVX DJML 2XVL-NC
2MB7 SDML K2BL X5GZ GBXT AWNL ZZQY 3QZ5-2D
TYXX WMDE OFRS RPE4 WUIS CJY2 H5OS NIXZ-DT
LVL5 JRSY EGAI DQOY UDQ4 4E7V DSRU SC3O-6A
2MNK CX2D 6BQR 5M3D AQK6 JFOS IZDG MGMK-SO
JJA6 VAWY O2XA ZQYP NNGY 4ENK TO72 QYHF-Y2
IZIQ YOKY CHIQ NOBJ RK3Q UUNL VWZF GPHL-CC
ABWV WAVZ ZIZL GSIG XDZF UWGE CXFA MVRD-FW
TEHW MIZI TBXT 475V RDZ6 222D UZMB 7YR4-4H
HODN MIJM KEDV IV7A V4IW ZBEQ RWYS GU2R-NW
B2O5 FSJZ 6MAE SUO3 YCPU ABNN OF5E AYKV-XK
MNIF ENSU 7JVW HXMD NOIG F4ZN WBI3 LDCJ-ND
YG2Z N3Y4 M2GT FN77 5MJU YK7Q KVXQ N4GH-LQ
XIAI CVUC ZMPN TLY6 YI5O TQXZ XEXN 5IJI-65
HXXI M23L ZNJX YGTE APWD S57K 3BFH 6O3C-KG
DIGP 3KH6 SZIL OUW4 IMTO AHXA NALW GE3M-EO
R2EZ A2FI OWVI 4Y4P A6GU JSP2 2YP3 ET5Z-OF
3GOV XUCI VCBS CVAH IXZW BJCV AJ62 TZEE-2S
DC5M 5FQU HYIQ DPX2 JO4Q 7CVD COBA GSKE-3M
WYDT Y22O EWMK EK6C ER6G 24P4 LNIP JTOX-DR
HYZT CKY2 72GI 7BUZ VNNL AMVN CBAC QNPL-KD
ESRA 2X65 JNTL FO4T E55P MKAY ZVDU K42I-YL
NREN Y5GS XIYE S7B4 QS6B 4RY4 3Z3H 57Y2-WW
RMRS VPS6 CUU5 OZKV OZSC ZB24 FVKX AMV2-WT
GVO2 OFRG 34JO VCPQ FUBU EECB JZCS RXKE-RH
2G7T DEAT PA7A 5ZIH EIFN CWAK TCZL ZRC7-2M
6K2O VQCW GOWP ECOC J4T2 BDFO OUB5 WIAL-D7
GAUW ABNC VDDZ XDSZ OUR3 AN5K ZCV2 KEUQ-OO
EQA3 AYQE FZF5 SSMB BBJU 3CHE D227 GCHS-IE
X3W6 AIQ-2T