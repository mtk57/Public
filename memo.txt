
■PoweerShell

<インストール/アップデート>
winget search Microsoft.PowerShell


■Gemini CLI
https://github.com/google-gemini/gemini-cli

<インストール/アップデート>
npm install -g @google/gemini-cli@latest



■Codex CLI
<インストール/アップデート>
npm install -g @openai/codex@latest

<環境構築>
1.WSL2を入れる
2.WSLからnode.js、codexを入れる

<起動方法>
1.PowerShellを管理者権限で開く
2.wsl
3.codex

<バージョン確認>
codex --version

<Tips>
- リポジトリにAGENTS.mdを入れておくとよいらしい。
  そんでもって、指示する前に以下を指示する。
  このディレクトリの AGENTS.md を読んで、記載のルールに従ってください。以後は日本語で説明して。指示があるまではファイルの更新は絶対にしないでください。

  ソースを読んで仕様を理解して、仕様の概要をAGENTS.mdに記載してください。
  ver1.0.6の仕様を追記しましたので、対応をお願いいたします。前バージョンのmdファイルは「AGENTS__old_1.0.5.md」です。
  AGENTS.mdの仕様を全て実装して。
  実装前に疑問点があれば確認してから実装を開始して。


  以下のタスクを、**5行以内で**、**最もシンプルな方法で**実装してください。
  - クラスや関数は必要最小限に。
  - コメント、エラーハンドリング、拡張性は一切不要。
  - 余計な処理や最適化は絶対に追加しない。
  - 動けばOK。


■ステップバイステップ
・各ステップを一気に述べるのではなく、1ステップを提示→そのステップをクリアするまで私とやりとりして
　クリアしたら次のステップに進む・・を繰り返すこと。



■WSL2
# pwdの結果をクリップボードにコピーする

pwd | clip.exe                           Linuxのパス形式でコピー
wslpath -w "$(pwd)" | clip.exe           Windowsのパス形式でコピー



■Visual Studio Community
#起動できなくなったとき：
1. %ProgramFiles(x86)%\Microsoft Visual Studio\Installer\InstallCleanup.exe を管理者権限で実行。
2. コマンド: InstallCleanup.exe -i 17（17 は VS2022 を指定）。
3. PC を再起動後、再インストール。

■Base32で使用される文字 (32文字。A-Z 2-7)
ABCDEFGHIJKLMNOPQRSTUVWXYZ234567


■
アップロードした文字列の画像をテキストにしてください。
ちなみに文字列のフォントはConsolasで、使用している文字種はBase32 + ハイフンのみです。（全て半角文字）



■Maven

# ビルド成果物を消して、最初からビルドして成果物をローカルリポジトリ（~/.m2/repository）に登録する （テストはスキップ）
mvn clean install

# ビルド  ※targetの下にjarが出来る
mvn clean package

# ビルド （テストはスキップ）
mvn clean package -DskipTests

# Springを起動
mvn spring-boot:run 

# Springを起動（テストはスキップ、ログ少なめ（-q））
mvn -q -DskipTests spring-boot:run

# Springを起動（テストはスキップ、ログ少なめ（-q）、プロジェクト指定（-pl））
mvn -pl job-01 -q -DskipTests spring-boot:run

# ライブラリのバージョン確認。以下はSpring Batchの例
mvn dependency:tree | grep spring-batch-core

# ターミナルのエンコードをUTF-8にする（pom.xmlを修正）
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>

            <!-- これを追加 >> -->

            <configuration>
                <jvmArguments>-Dsun.stdout.encoding=UTF-8 -Dfile.encoding=UTF-8</jvmArguments>
            </configuration>

            <!-- これを追加 << -->

        </plugin>
    </plugins>
</build>


# JARの中にファイルがあるか確認。
jar tf job-01/target/job-01-0.0.1-SNAPSHOT.jar | grep messages.properties

# 以下のような結果が出れば存在する
BOOT-INF/classes/messages.properties


■H2   ※メモリ型のDB

# SpringBoot起動時のログに以下が出ていればH2に接続できている状態
HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA

JavaとH2の型 (代表的なもののみ)
String        → VARCHAR / CLOB
int           → INT
long          → BIGINT
BigDecimal    → DECIMAL
boolean       → BOOLEAN
LocalDate     → DATE
LocalDateTime → TIMESTAMP
byte[]        → BLOB / VARBINARY


■Linux

# 8080ポートを誰がListenしているか?
ss -ltnp | grep 8080

# 全ファイル/フォルダを表示
ls -a

# フォルダをzipに
zip -r myproj.zip myproj -x '*/.git/*' '*/target/*' '*/node_modules/*' '*/mta_archives/*' '*/.vscode/*' '*/.gen/*'




■VS Code

# フォントサイズ
拡大：Ctrl + +
縮小：Ctrl + -
左の歯車 → Settings → Editor: Font Size

# mdファイルをプレビュー  (拡張入れなくもOK)
CTRL + SHIFT + V

# プロジェクトのコピー
cd ~/projects
cp -r src dst
→Mavenの場合、pom.xmlをartifactidを変える

# ファイル検索
画面中央上の虫眼鏡

# ファイル内検索
画面左の虫眼鏡

# BASリロード
Ctrl + Shift + P → "Developer: Reload Window"


■Git

rm -rf .git
git init
git add .
git commit -m "first commit"
git remote add origin https://github.com/mtk57/SoapServerTest2.git
git branch -M main        # GitHub側が main ブランチの場合
git push -u origin main

# clone
1.左のSource ControlのCHANGESの...からclone
2.githubのURLを入れる

git clone https://github.com/mtk57/BatchH2MyBatisTest2.git

# git管理対象をツリー表示
git ls-tree -r --name-only HEAD | tree --fromfile .


■Cloud Foundry/HANA Cloud

# HANA Cloud Central に行く手順 (BTP Cokckpit)
1.Instances and Subscriptions
2.SAP HANA Cloud
3.Go to Application


# SAP HANA Cloudを開始する手順
1.HANA Cloud Central → Instances
2.対象インスタンス行の Actions（…） を開く
3.Start


# HANA Cloud Central で接続元IPを許可する手順
1.HANA Cloud Central → Instances
2.対象インスタンス行の Actions（…） を開く
3.Manage Configuration をクリック
4.タブで Connections を開く 
5.Allowed connections（許可する接続）で、次のどちらかを選ぶ
  まず切り分けしたい → Allow all IP addresses（一時的） 
  きちんと制限したい → Allow specific IP addresses and IP ranges
  「Allow specific…」を選んだ場合、許可IP（またはCIDR）を追加
   例：203.0.113.45/32（1つのIPだけ許可）
6.Review / Save（保存）で確定 

HANA Cloud はデフォルトで “全IP拒否” なので、ここを設定しないと外部から基本つながりません。

BAS から接続する場合の注意（ここで詰まりやすい）
許可すべきIPが あなたのPCのグローバルIPではなく、BAS側の出口IP になることがあります。
BASから見える外向きIPを確認
curl -s https://api.ipify.org ; echo

ここで出たIPを /32 を付けて allowlist に入れるのが手早いです。




# SAP HANA Database Explorer
1.HANA Cloud Central → Instances
2.対象インスタンス行の Actions（…） を開く
3.SAP HANA Database Explorer
4.左の「+」でAdd Instance画面を開く
5.Instance Typeで HDI Containerを選ぶ
6.ログインするリンクするみたいなのをクリック












■SAP BTP BASのSpring BatchからH2コンソールを使う
1.pom.xmlに以下を追加。(H2はメモリDBなのでバッチのようにアプリが終わってしまう場合はTomCatを常時起動しておく必要がある)
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-web</artifactId>
  </dependency>

2.application.properties
  spring.main.web-application-type=servlet  # Webサーバとして起動する
  #spring.main.web-application-type=none    # Webサーバとして起動しない(バッチアプリはこれ)

  spring.h2.console.enabled=true                    # H2コンソールを有効
  spring.h2.console.path=/h2-console                # 後で出てくるURLに付けるパス
  spring.h2.console.settings.web-allow-others=true  # H2コンソールを外部からアクセス可能にするか否か

  spring.batch.job.enabled=false        # バッチジョブの自動起動有無。falseだとアプリが起動してもジョブは起動せずWebサーバだけが立ち上がる
                                        # 以下のようなログが出ていなければ自動起動は抑止されている
                                          JobLauncherApplicationRunner : Running default command line with: ...
                                          Job: [SimpleJob: [name=sampleDataJob]] launched with the following parameters: ...
  spring.profiles.active=local          # テスト用/本番用の切り替え
  #spring.profiles.active=cloud         # テスト用/本番用の切り替え

3.ビルドしてアプリを起動する
  ログに以下が出ていればOK
  Tomcat started on port 8080 (http) with context path '/'
  H2 console available at '/h2-console'.

4.Ctrl + Shift + P
  Ports: Preview
  8080
  →ブラウザで新しいタブが勝手に開く
  
5.開いたタブのURLの末尾に
  /h2-console
  →H2コンソールが開く

6.H2コンソールのJDBC URLを
  jdbc:h2:mem:testdb
  にして「Connect」

この方法だとバッチが最後まで走り切った状態のDBを覗くことになるので
バッチが走る前にDBを変更したい場合は、

7.以下のクラスを追加
package com.example.batch_h2_mybatis_chunk_test.web;

import java.time.Instant;
import java.util.HashMap;
import java.util.Map;

import org.springframework.batch.core.Job;
import org.springframework.batch.core.JobParameters;
import org.springframework.batch.core.JobParametersBuilder;
import org.springframework.batch.core.launch.JobLauncher;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@Profile("local")
@RestController
public class JobRunController {

    private final JobLauncher jobLauncher;
    private final Job sampleDataJob;

    public JobRunController(JobLauncher jobLauncher, Job sampleDataJob) {
        this.jobLauncher = jobLauncher;
        this.sampleDataJob = sampleDataJob;
    }

    @GetMapping("/run-sample-job")
    public ResponseEntity<String> runJob() throws Exception {
        // ジョブパラメータに時刻を入れて、毎回別ジョブとみなしてもらう
        JobParameters params = new JobParametersBuilder()
                .addLong("runAt", Instant.now().toEpochMilli())
                .toJobParameters();

        jobLauncher.run(sampleDataJob, params);

        return ResponseEntity.ok("sampleDataJob started");
    }
}

8.ビルドして、手順3～6を実施

9.まだジョブは起動していないので、DBを変更しておく。

10.URLの/h2-console以降を
  /run-sample-job
  に変更
  →画面にsampleDataJob startedが出るのでジョブが開始される

11.元に戻すときは
   application.propertiesから以下をコメントアウト
   #spring.h2.console.enabled=true
   #spring.h2.console.path=/h2-console
   #spring.h2.console.settings.web-allow-others=true
   #spring.batch.job.enabled=false

   #spring.main.web-application-type=servlet
   spring.main.web-application-type=none

----------
BFHA K4FS YJHZ VQ3U AKK2 J4W2 FCWC FOFM-64
ADY2 LNNU GOAZ VRDI 6RHA CS6E FV27 OWOS-US
NMYS XRLF P5EJ DILX LMG4 KFF4 6ARE 7XGC-54
GDRO WNPH ZUJH JCIL TUKJ FITV YXKF CGTR-J5
VSJB 6U6Z 363D B7QX NI2I EL2H T72E 5XAI-FS
6KYY XTKM Q4SU LRAT QL7S WWCB NH3G N23H-NS
RQZE O3W2 Z2M5 YZYN GAS5 PQ7L HSZU 6YET-UR
5OMH YDR4 HZGF PWIU 7UZU FXKR HDY5 T7X6-WL
GOUC K6R3 TTUQ BMHO WGKT E7KX CGNC SUAC-MN
HD5K KE6N NQ5H Y56Y BUZH QFGY MSMY 77XT-CP
TUF6 ICII TFWF QQB5 KOD2 INM2 MY2B GM4T-5L
TWLR O2AA GA3S YPHD O2QT SJUY Y5ME ZYWN-6Q
G2U6 HJTS I4M6 4XZL QGZB EM4U BTGA SY6M-NJ
6S5T L77K ID4B X5EX 6GJA 4NZW 47M4 4UOL-E5
JYMX ZKP2 TLEX QDPS ZFYW VVXE 6K74 7HAN-CH
S2Z2 C6NB QDON MDWU 5EBP 5ULY TCAV ZEHX-6X
MPRM GRJI A5WM B35W KLCY WLCX SB7S DJGS-A3
TZ2P 4IPY 2JMG XRHA MY4J DNPZ 325F EHG2-GJ
IJ2A HHDA 3PHA LXYM OUJW QFWT 6JC4 4IOH-F5
NNF2 UQXM PX6M 3FZN NNTH JWXN B5WM RFZM-3O
KDYB C42F D4WM GPC7 XDBS Z4J4 4WBX XV7F-5F
MYF5 BP6X DKGG GREW 3H2S COJ7 D6FR 3AYO-32
BFOT 6MSQ MLHP BYI4 RKPK W5HO BLXE V4NL-7N
VZLG SIQO 6S2S 5NT6 UJ67 C3LH DPY2 3267-JL
AMRK 6NGB GOFD Z22I LVAI SOCD GQZR PM7F-4K
EODL T7X4 IUJS P7KZ BFA7 5QUE V3O7 24A2-6Q
WLM7 3TXD 42AN SQPH DM4M 6KQ5 EYEC W5NY-ZP
DJBR JRTA TPDT VTQK ZFYO JZAY JFZA FSCY-AF
Y7FT GU3O G7KA UAIJ QEFB H4XQ 7GTO 7V4Q-5V
U3DX O5BN MU6J LUHE QNCN 37LD QAWX 2QEJ-PR
JFUY QYTK OT5L CGOK RTJ2 JOSP GXGR 2Z7W-MP
H7NV 45EZ W6P5 7FB3 YZIS M4Q5 BW5A L5J7-G4
JOII A6YP JA4T RDOJ 5OZ4 NQM5 QDDO ABQ3-NP
BWMK ACSH PUZB K6QI RAA5 2NHN BFZO XOUT-GI
H2WT UBMX LLC2 4OTO A73X 3OXY FZF6 7EBX-IO
RISN DUAY DJAN E6Q3 Z2TA PUD7 OI6T I6W2-3K
KK46 J6X7 ISFU US3J FZFQ DCYT QOTJ XQ3E-DZ
OAJY N3FH HOIJ FNPS EZLC GWQ6 4ZJO 6IKW-GO
25XE 2AJ6 RCP5 M5JP MS3J WC2T NKWJ ODZJ-AV
3LZW 7DX2 WV5C KOIV V2ST QGMK 3U4J 7E6Y-MR
HUAD OL5N SP6A 7HST QROF 2SEJ JUJM PPBH-F2
GVUA MHFV ENI2 HPOR TB5L GTTY 75CZ R4B3-EY
PLSN N3AT LM6V 5ACJ 7N26 LBJX C7UE NIJ5-7I
KQNG Y6CQ 7Y6X KPQZ LMJE S7YW GFZA T6NU-AZ
ZDH6 U2JG JS4D R7CT OBP7 K6KU D442 X7KO-AF
RPFR 3XPJ EPOV O4LZ HGYK WJL7 PRDQ E5K7-ZG
Q52H 3P4N VHGV NFUT VN7B ACC6 3FOL CDL6-GQ
HB7Y SH7C GZFZ V26V GFSY SQZA DZZZ PMRB-HP
33JJ BFNP 3YZM TLOY CAKG U3CJ 3IL2 BGIQ-VR
KMGO BGPO KVKK FTV5 7MND 7QFQ UPPB 3JMC-PZ
A3UE IB4R SFF7 MS74 GULC 3SFK FCMV BT4W-AN
AF2D CAQX IYYZ NLLN 4GJQ TA5I AOZG SOY5-TL
VAJJ XNZT 5EE4 PRDU EZAP VUSQ DHE2 574M-BS
T544 4WUD KMII IAS2 TWCY K5LD BSG2 527W-KQ
XRGQ 4QGZ AQAE US2K NPWP 25BK G554 EF7X-2H
J323 HM6V VCDZ EJD4 T4GX 77ZZ BRTO GGRN-OB
GJ3A HO64 XREN BWAE ZDNL OUJL XTEP RGIL-CD
EZRX 26MQ G6UY SMPY CHDD EPAS T4LX VRCB-R2
OGG6 EYO3 RTVO VGKH IJV5 DAJM 3H2I XAFD-KN
RLNT UCPN 26PI BY7J 53Z4 V3WW YBLA RWOF-PA
B33B HQZR TTMG W7V7 43UR HEC4 U2FK CJUS-AF
4L3T C5XV JKUQ TSEY B5O4 UEXL A7NM BCWU-GH
NAW5 ACYM 4A5V PICO HTIY EZG6 4Y54 7FU5-AH
2KAG 2RIB M4U6 M4VF HY4B CSFA JBCA TVVB-JL
EZCO PWE2 W6ZD P4CD QNYP AGSE T57C DAOF-WA
B5ZJ F4VG E6ZO OU6N IU7K CKCL P7C6 YZZD-LI
KY6C SKBO LLLF PAHB LATQ 77CZ EPTU VXXH-4Y
ZZEO WFWX ERIB SAZY 55OI APJ7 WGYJ YVPJ-7F
C72V QSXL 3XYB VL77 5QAF YUTC TW2V OPOL-PP
7KRA DZJU GNBO JFRU 2I57 2MLJ JMIK LNMH-2D
ML7Z 76PT JKJV TIC4 7W7K 2D5Q IZO2 E7XI-S5
QB7G PHPJ DSKT XN2B MRYG ASPK WRXJ 57JR-6K
3R3V ADBF MACR IMKE D4QH 2E5S 72Z3 J452-C7
4U3P VTUE TLQR OCMJ NQKD KH32 6FOB UBNC-XV
DW3E 3J73 VNKZ X35J 3F3U KBKT SNX3 3IRB-D4
ABDC JTPJ D46B VDBE BAWZ 42S3 SF67 YGJA-QY
YUD4 ERJQ PXIX CQ77 R3P7 JXGT SVHC ECJS-JN
PBAL 4H42 5DU5 4NFR FJ53 LIWW 3P7S PHTD-52
RX7A XWIJ ASP2 EMLU 57IY 2RBG SLZS B3NX-NX
7GD4 DSOU Z4AJ YOBX TUCR YNNE 22FC QPIJ-VP
ULPS X63K NRHS MTC2 4CYB MWYB UDZL AGTH-LT
BW56 7BZ2 Q7EH 4HLP LCLX S5CC JFA4 KVJU-IG
SVXA WNKG NYBA LM6P RMEL XT4C Y4HD J43H-VT
CNFF YKE3 5PUK NKKU QEMY Z6RX L7CG 3QXQ-N3
3LG2 4SVW 65QX SXQ2 SKIE RNBX GWUA BIK7-3P
E3KV 6DTM RVWW VCBA JGKB ERN4 VCTP 3VS4-2I
BEN7 O3QG 3YYV RPVU 2LZD 7WZJ SBDD LMCR-GB
6ITA NCAR KETP 524C HD6U 5PYB MVDV YZ6P-CT
XCN5 N75O SXAC Q6SA ES33 R5BI DPCW YQFN-2F
C2KQ WDLV 56UH 75VF NSD7 NBMY TLV2 3PHT-A3
B2FL NKNI 2QAQ TB3E TEZS FC3L SZIW UWTM-SF
6WDZ 5NEY HM5R ENFL UOIL 2CTD LPOW J6PT-WZ
5SMP T73X XJBX VRQQ FUBQ NWZC F6PG MDQV-OW
5XIR OMNJ YYKM 3DUM TVJT LBDP AXGZ IJVV-GY
A6NP PS3Y GOKF DEDV FKVW 6L7M QQUQ 7DG5-N7
4V26 J34J UYTZ TPD5 BAFK JTEF IUEV U2SH-5W
MPYE ZK53 ER35 YWYY EBSE EYFI JXDB S64U-P3
ERTJ N2HB W2OQ X4WY DVBS E62U XHO2 PSLU-2G
5GA3 IZNK N6JJ WP7H 3M2Y 4IRX 5OMU JI5X-EY
3M2H 32KK HEC4 AV62 MSXR TRWU EL5N 62A4-57
UW6H EL4C ERTF MNIK W2IV KPTQ LJXE BJIJ-MS
JL2W KMBF BBME MWEC SN34 6VL2 5TAI LKUD-LO
DKAF PMIW K2MQ BOKJ XIWT ZOR5 EBLR A3RM-FW
ZC5B 3ODB LEYL JZZE VYSE 4JKF O7W2 CRW3-BF
N7W2 L7YO REAE PYEJ 4R4V H7QH XSLX G6VS-7N
OYO2 O5YE SPBX JUUV VOZT MJGS IHFD LGYB-G7
2BMS QAWO 2MZL 3HQY ISW6 EWAM 7BYY VNMD-55
VQIB TUST YYWR CUAW US36 KC67 KCFB HTTS-CS
Y5M5 N4RG ZR6A BPY5 H4NL KNCI 6ZEM HDQD-EW
N7K2 FXWH 3OG6 ZXJN 6RKV SSYG HLH7 4K6Z-ZF
TDJR KD7H M5SY G-ON