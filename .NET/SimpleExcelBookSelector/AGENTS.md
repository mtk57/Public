# AGENTS.md
## 出力言語
このリポジトリに関するすべての説明・要約は日本語で記述してください。コードは変更せず、そのまま出力してください。

## SimpleGrep 仕様  Version 1.3.8

## 仕様概要
- WinForms製のユーティリティで、現在稼働中のExcelインスタンスからブック（必要に応じてシート）を列挙し、一覧から素早く切り替え・操作できる「Simple Excel Book Selector」を提供する。
- メイン画面ではピン状態・フォルダ・ファイル・シート・更新日時列を持つグリッドを表示し、列ヘッダクリックでソートを切り替える。選択行のExcelブック／シートを前面化し、強制更新ボタンやシート選択モード切替、フォルダを開くかファイルを開くかのトグル、履歴管理画面の起動ボタンを備える。
- 自動更新モードが有効な場合は指定秒数（1秒以上）ごとにCOM経由で最新のExcelブック一覧を取得し、変化がない場合は描画を抑制する。設定値はアプリ起動ディレクトリの`settings.json`に保存され、旧形式からの移行にも対応している。
- グリッド上では左上セルクリックで全選択、Ctrl+Tabで選択行の前後移動と対象ブックのアクティブ化、Ctrl+Wで選択ブックをExcelに対して閉じるコマンド送信を行う。行ダブルクリック時は設定に応じて対象ブックまたはそのフォルダを`Process.Start`で開く。
- Excelブックを検出すると最終更新時刻付きで履歴に追加し、ピン留めは常に上位に並べ替える。履歴は最大50件（非ピンのみ削除）を保持し、履歴管理画面で削除したパスは再検出されるまで一時的に一覧から除外する。
- 履歴管理画面は履歴リストを複製して編集し、フィルタ入力・列ヘッダソート・全選択トグル・選択項目の開く／削除／ピン切替・ピン済み全体を開くといった操作を提供する。OKで確定時に変更が本体設定へ反映され、キャンセル時は破棄される。


# Version 1.3.8 で変更
- 履歴管理画面に「ダブルクリックでフォルダを開く」チェックボックスを追加。（メイン画面と同じ仕様）※json保存対象
- 履歴管理画面のフィルタテキストボックスをコンボボックス化してフィルタに入力されたキーワードを履歴を10個まで保持する。※json保存対象
- 履歴管理画面のDataGridViewの更新日時はファイルの更新日時を表示するように変更する。
