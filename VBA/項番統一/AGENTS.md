# AGENTS.md
## 出力言語
このリポジトリに関するすべての説明・要約は日本語で記述してください。コードは変更せず、そのまま出力してください。

## 作業概要
Excelシートの指定列（複数可）の項番を1から連番になるように振り直す

## 言語
Excel VBA

## 仕様詳細  Version 1.0.7

# 画面のUI
- 実行ボタン：押下することでマクロを実行する。
- ファイル名：C6セルに入力されたExcelファイル名（絶対パス or ファイル名）を処理対象とする。（必須）
              すでに開いているファイルも対象とする。（必須）
- シート名  ：C7セルに入力されたシート名を処理対象とする。（必須）
- 大項番列名：C8セルに入力された列名（A～）を処理対象とする。（必須）
- 中項番列名：C9セルに入力された列名（A～）を処理対象とする。（任意）
- 小項番列名：C10セルに入力された列名（A～）を処理対象とする。（任意）

# 処理概要
- 実行ボタン押下時
 - 必須入力項目チェックを行い、エラー時は処理を中断する。（エラーダイアログ表示）
 - ファイル名に入力されたファイルを開く。
 - シート名に入力されたシートをアクティブにする。
 - 大項番列名の行を上から下に操作し、1、2、3・・・nのように1からの連番になっているかチェックし、
   1の次に3があった場合は3を2に変更する。1から始まっておらず2を最初に検知したら1に変更する。
 - 中項番列名の行を上から下に操作し、1.1、2.1、3.1・・・m.nのようになっているかをチェックし、なっていなかったら変更する。
 - 小項番列名の行を上から下に操作し、1.1.1、2.1.1、3.1.1・・・m.n.oのようになっているかをチェックし、なっていなかったら変更する。


# 項番について
- 中項番、小項番は必ず存在する訳ではない。
- セルの書式が標準の場合、"'1"のように左寄せにするために項番の先頭に"'"が入っている場合があるのでそれも考慮して処理する。
- 項番は"1"のように数字のみ場合や、"1 初めに"のように数字の後に文字列が入る場合があるがどちらも考慮する。

- パターン1：大項番のみ場合1
  1
     Hoge
  2
     Fuga

- パターン2：大項番のみ場合2
  1 はじめに
     Hoge
  2 おわりに
     Fuga

- パターン3：大項番+中項番
  1
    1.1
         Hoge
    1.2
         Fuga
  2
    2.1
         Moge
    2.2
         Moga

- パターン4：大項番+中項番+小項番
  1
    1.1
      1.1.1
         Hoge
      1.1.2
         Fuga
  2
    2.1
      2.1.1
         Hoge
    2.2
      Fuga


# 仕様追加  ver1.0.7
- 開始番号：C11セルに入力された値(0以上)を開始番号として振り直す。（空の場合はデフォルトの1を開始番号とする）


